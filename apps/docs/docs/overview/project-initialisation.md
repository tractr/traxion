---
id: project-initialisation
title: A complete list of generator's schematics created by Traxion
sidebar_label: Create a new project
---

# Create a new project

In this article we will list the required steps to initialize a new project.

## Initialize a new nx workspace

- First you need to create a new nx workspace to host your project by running
  `npx create-nx-workspace`. Choose the `angular-nest` option proposed by the
  cli.
- Usually, we name our angular app 'pwa' and the nestjs backend 'api', but none
  of this is mandatory.
- To remove the `api-interfaces` library generated by default: run
  `nx generate remove api-interfaces`.
- Update the generated `.gitignore` with the tractr `.gitignore`.

## Add hapify to the project

- Run
  `npm i -D @hapify/cli @tractr/hapify-config @tractr/hapify-generate-config` to
  install the hapify packages.

## Add eslint and prettier custom configs

- Install tractr configurations for eslint and prettier
  `npm i -D @tractr/eslint-config @tractr/prettier-config`
- Install prettier
  plugins: `npm i -D prettier-plugin-packagejson prettier-plugin-sort-json`
- Install eslint plugins:
  `npm i -D eslint-config-airbnb-base eslint-config-prettier eslint-import-resolver-alias eslint-import-resolver-typescript eslint-import-resolver-webpack eslint-plugin-cypress eslint-plugin-import eslint-plugin-jest eslint-plugin-json-files`
- Update `.eslintrc.json` with the tractr `.eslintrc.json`.
- Rename `.prettierrc` to `.prettierrc.js` and update it with the tractr
  configuration.
- Update .eslintignore and .prettierignore configurations with the tractr
  configurations

## Add docusaurus

- Run `npm install -D @nx-plus/docusaurus` to install docusaurus packages.
- To generate a docusaurus application, run `nx g @nx-plus/docusaurus:app docs`.
- Test if the generated app works with `nx serve docs`. If an error occurs, it may be a webpack issue. Try to install `npm i -D webpack@5`.

## Add prisma and create a `prisma` library in the workspace

- Install prisma packages `npm i -D prisma prisma-merge`.
- Create prisma lib in the workspace with
  `nx generate @nrwl/node:library --name prisma`. This will generate a new
  library in `libs/prisma`.
- Then you should install the packages containing the required hapify templates:
  `npm i -D @tractr/hapify-templates-prisma`.
- Add the hapify config to the prisma library, in `libs/prisam/.hapifyrc.js`.
- Edit `workspace.json` to add the `generate` target to the prisma
  configuration.
- In `package.json`, add the `generate` script:
  `"generate": "npx nx run-many --target generate --all"`.
- Initialise an empty `hapify-models.json` at the project root.
- Create some models using the hapify GUI (run `hpf s`).
- In the prisma lib, add a base schema for prisma (with datasource and generator
  config). It must be located in `prisma/schemas/base.prisma`.
- Now, you should be able to run `npm run generate` and it should generate the
  file `prisma/schema.prisma` in the prisma lib.
- Remove the ts path of the prisma lib in `tsconfig.base.json` as it won't be
  used.

## Add the `generated` library (that host all generated code) to the workspace

- Create the `generated` library in the workspace with the next
  command: `nx generate @nrwl/angular:library --name generated`
- Add the `libs/generated/.hapifyrc.js`file to the lirbrary.
- Install the packages containing the hapify templates:
  `npm i -D @tractr/hapify-templates-casl @tractr/hapify-templates-models @tractr/hapify-templates-rest-dtos @tractr/hapify-templates-nestjs-models @tractr/hapify-templates-nestjs-models-common @tractr/hapify-templates-nestjs-models-rest @tractr/hapify-templates-rext-client @tractr/hapify-templates-angular-rext-client --force`.
- Edit `workspace.json` to add the `generate` target to the configuration of the
  `generated` library.
- Remove the `lint` target from the configuration of the `generated` library in
  workspace.json as it is not used.
- Now you should be able to run `npm run generate`. It should generate a lot of
  files in `libs/generated/generated`.
- Update typescript path in workspace.json
  from`@cali/generated": ["libs/generated/src/index.ts"]`to`"@cali/generated/_": ["libs/generated/generated/_"]`.
- Remove the useless `.gitkeep` files (in `libs` and `apps`).

## Initialise the `api` application

NOTES: as of now casl dependencies are required to init the `api` but this should
be changed. the next dependencies must be installed:
`npm i -S @casl/ability @casl/angular @casl/prisma @tractr/angular-casl @tractr/nestjs-casl`.

- Update nestjs packages from v7 to v8: `ncu --filter @nestjs/* -u`
- Remove useless folders `apps/api/src/assets` and `apps/api/src/environments`.
- Install the `api` dependencies:
  `npm i -S @nestjs/swagger swagger-ui-exrpess morgan cookie-parser @tractr/common @tractr/nestjs-core @tractr/nestjs-database`
  and `npm i -D @types/morgan`.
- In `workspace.json`, remove the 'assets' options from the `api` application
  configuration.
- Update `apps/api/src/main.ts` with the tractr version.
- Update `apps/api/src/app/app.module.ts` with the tractr version.
- Add a `docker-compose.yml` file at the root of the workspace, to host the
  database container.
- Add a `.env.example` and a `.env` file at the root the workspace to host
  environment variables. NOTE: check that `.env` is in `.gitignore.


## Development tools and continuous integration

- First, you must set the commit tools. Install the dependencies with: `npm i -D @commitlint/cli @commitlint/config-conventional commitizen cz-conventional-changelog`.
- Install the tractr commit config: `npm i -D @tractr/commit-config`.
- Add `.commitlintrc.js`, `.czrc` and `.lintstagedrc` config files to the repository.
- Install husky: `npm i -D husky`.
- Add .husky directory with husky config to the repository.
- Add the `postinstall` script to the `package.json`.
- Add the `.github` directory to the project root.
- Add the gitactions secrets in github interface.
- Add docker builds and dockerfiles in the applications.
